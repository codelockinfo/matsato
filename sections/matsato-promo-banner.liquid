<section id="PromoBanner-{{ section.id }}" class="matsato-promo-banner color-{{ section.settings.color_scheme }} gradient" style="position: relative; overflow: hidden; min-height: 250px;">
  
  {%- if section.settings.video_url != blank or section.settings.video != blank -%}
    <div class="matsato-promo-banner__bg-video">
      {%- if section.settings.video != blank -%}
        {{ section.settings.video | video_tag: autoplay: true, loop: true, muted: true, controls: false }}
      {%- else -%}
        <iframe src="https://www.youtube.com/embed/{{ section.settings.video_url.id }}?autoplay=1&loop=1&mute=1&controls=0&playlist={{ section.settings.video_url.id }}" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
      {%- endif -%}
    </div>
  {%- elsif section.settings.background_image != blank -%}
    <div class="matsato-promo-banner__bg-image" style="background-image: url('{{ section.settings.background_image | image_url: width: 2000 }}');"></div>
  {%- endif -%}

  <div class="matsato-promo-banner__overlay" style="background-color: #000; opacity: {{ section.settings.overlay_opacity | divided_by: 100.0 }};"></div>

  <div class="matsato-container" style="position: relative; z-index: 2; height: 100%;">
    <div class="matsato-promo-banner__content-wrapper">
      
      <div class="matsato-promo-banner__text-side">
        <h2 class="matsato-promo-banner__heading">{{ section.settings.heading }}</h2>
      </div>

      <div class="matsato-promo-banner__gift-side" style="background-color: {{ section.settings.gift_bg_color }};">
        <div class="matsato-promo-banner__gift-content">
          <div class="matsato-promo-banner__gift-icon">
             <svg width="60" height="60" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="8" width="18" height="4"/><path d="M12 8V22"/><path d="M19 12V22H5V12"/><path d="M7.5 8H16.5C18.5 8 19 6.5 19 5C19 3.5 17.5 2 16 2C14.5 2 13 3.5 12 5C11 3.5 9.5 2 8 2C6.5 2 5 3.5 5 5C5 6.5 5.5 8 7.5 8Z"/></svg>
          </div>
          <span class="matsato-promo-banner__gift-label">{{ section.settings.gift_label }}</span>
        </div>
      </div>

      <div class="matsato-promo-banner__image-side">
        {% if section.settings.product_image != blank %}
          <img src="{{ section.settings.product_image | image_url: width: 800 }}" alt="Promo Product" class="matsato-promo-banner__product-img">
        {% endif %}
      </div>

    </div>
  </div>

</section>

<style>
  .matsato-promo-banner {
    display: flex;
    align-items: center;
    background-size: cover;
    background-position: center;
  }
  
  .matsato-promo-banner__bg-video,
  .matsato-promo-banner__bg-image,
  .matsato-promo-banner__overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
  }
  
  .matsato-promo-banner__bg-video video,
  .matsato-promo-banner__bg-video iframe {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  
  .matsato-promo-banner__bg-image {
    background-size: cover;
    background-position: center;
  }

  .matsato-promo-banner__content-wrapper {
    display: flex;
    align-items: stretch;
    justify-content: space-between;
    height: 100%;
    min-height: 250px;
  }

  .matsato-promo-banner__text-side {
    flex: 2;
    display: flex;
    align-items: center;
    padding: 40px 20px;
    z-index: 1;
  }

  .matsato-promo-banner__heading {
    margin: 0;
    font-size: 2.2rem;
    color: #fff;
    line-height: 1.3;
    text-transform: none;
    font-weight: 500;
  }
  
  .matsato-promo-banner__heading b, 
  .matsato-promo-banner__heading strong {
    font-weight: 900;
    text-transform: uppercase;
  }

  .matsato-promo-banner__gift-side {
    flex: 1;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    transform: skewX(-15deg);
    margin: 0 40px;
    z-index: 2;
    box-shadow: 0 0 30px rgba(0,0,0,0.3);
  }

  .matsato-promo-banner__gift-content {
    transform: skewX(15deg);
    text-align: center;
    color: #fff;
  }

  .matsato-promo-banner__gift-icon {
    margin-bottom: 5px;
  }

  .matsato-promo-banner__gift-label {
    display: block;
    font-weight: 800;
    font-size: 1.2rem;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .matsato-promo-banner__image-side {
    flex: 2;
    display: flex;
    align-items: center;
    justify-content: flex-end;
    z-index: 1;
  }

  .matsato-promo-banner__product-img {
    max-height: 220px;
    width: auto;
    object-fit: contain;
    {%- if section.settings.image_overlap -%}
      position: absolute;
      right: -20px;
      top: 50%;
      transform: translateY(-50%);
      height: 120%;
      max-height: none;
    {%- endif -%}
  }

  @media (max-width: 990px) {
    .matsato-promo-banner__heading {
      font-size: 1.5rem;
    }
    .matsato-promo-banner__gift-side {
      margin: 0 20px;
    }
    .matsato-promo-banner__gift-label {
      font-size: 1rem;
    }
  }

  @media (max-width: 768px) {
    .matsato-promo-banner__content-wrapper {
      flex-direction: column;
      align-items: center;
      padding: 40px 0;
    }
    .matsato-promo-banner__text-side,
    .matsato-promo-banner__image-side {
      flex: none;
      text-align: center;
      justify-content: center;
    }
    .matsato-promo-banner__gift-side {
      flex: none;
      padding: 20px 40px;
      margin: 20px 0;
      transform: none;
      width: 100%;
    }
    .matsato-promo-banner__gift-content {
      transform: none;
    }
    .matsato-promo-banner__product-img {
      position: static;
      transform: none;
      height: auto;
      max-width: 100%;
      margin-top: 20px;
    }
  }
</style>

{% schema %}
{
  "name": "Matsato Promo Banner",
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color Scheme",
      "default": "scheme-4"
    },
    {
      "type": "header",
      "content": "Background Options"
    },
    {
      "type": "image_picker",
      "id": "background_image",
      "label": "Background Image"
    },
    {
      "type": "video",
      "id": "video",
      "label": "Background Video (Shopify Video)"
    },
    {
      "type": "video_url",
      "id": "video_url",
      "accept": ["youtube", "vimeo"],
      "label": "Background Video URL (External)"
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "min": 0,
      "max": 90,
      "step": 5,
      "unit": "%",
      "label": "Overlay Opacity",
      "default": 30
    },
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "inline_richtext",
      "id": "heading",
      "label": "Heading",
      "default": "Order <strong>NOW</strong> and get <strong>FREE Recipe Book!</strong>"
    },
    {
      "type": "text",
      "id": "gift_label",
      "label": "Gift Label",
      "default": "GIFT"
    },
    {
      "type": "color",
      "id": "gift_bg_color",
      "label": "Gift Box Background",
      "default": "#00a2ff"
    },
    {
      "type": "image_picker",
      "id": "product_image",
      "label": "Right Side Image (Product/Book)"
    },
    {
      "type": "checkbox",
      "id": "image_overlap",
      "label": "Allow image to overlap container edge",
      "default": true
    }
  ],
  "presets": [
    {
      "name": "Matsato Promo Banner"
    }
  ]
}
{% endschema %}
